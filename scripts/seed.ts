import { PrismaClient } from "@prisma/client";

const database = new PrismaClient();

async function main() {
    try {
        console.log("üå± Iniciando poblaci√≥n de la base de datos...");

        // Crear categor√≠as espec√≠ficas para programas t√©cnicos
        const categories = [
            { name: "T√©cnico en Computaci√≥n" },
            { name: "T√©cnico en Electr√≥nica" },
            { name: "T√©cnico en Mec√°nica" },
            { name: "T√©cnico en Electricidad" },
            { name: "T√©cnico en Soldadura" },
            { name: "T√©cnico en Refrigeraci√≥n" },
            { name: "T√©cnico en Automotriz" },
            { name: "T√©cnico en Construcci√≥n" }
        ];

        console.log("üìö Creando categor√≠as t√©cnicas...");
        for (const category of categories) {
            await database.category.upsert({
                where: { name: category.name },
                update: {},
                create: category
            });
        }

        console.log("‚úÖ Categor√≠as t√©cnicas creadas exitosamente");

        // Obtener categor√≠as creadas
        const computacionCategory = await database.category.findFirst({ where: { name: "T√©cnico en Computaci√≥n" } });
        const electronicaCategory = await database.category.findFirst({ where: { name: "T√©cnico en Electr√≥nica" } });
        const mecanicaCategory = await database.category.findFirst({ where: { name: "T√©cnico en Mec√°nica" } });
        const electricidadCategory = await database.category.findFirst({ where: { name: "T√©cnico en Electricidad" } });

        // Crear programas t√©cnicos reales
        console.log("üéì Creando programas t√©cnicos...");
        
        const technicalPrograms = [
            {
                userId: "instructor_tech_1",
                title: "T√©cnico en Reparaci√≥n de Computadoras",
                description: "Programa t√©cnico de 18 meses para formar especialistas en diagn√≥stico, reparaci√≥n y mantenimiento de equipos de c√≥mputo. Incluye hardware, software y redes b√°sicas.",
                imageUrl: "/programs/computacion.jpg",
                price: 0, // Sin precio para programas t√©cnicos
                isPublished: true,
                categoryId: computacionCategory?.id,
                chapters: [
                    {
                        title: "Introducci√≥n a los Componentes de Hardware",
                        description: "Conoce los componentes b√°sicos de una computadora: motherboard, procesador, memoria RAM, disco duro, fuente de poder. Aprende a identificar cada componente y su funci√≥n espec√≠fica en el sistema.",
                        videoUrl: "https://www.youtube.com/watch?v=hardware-basics",
                        position: 1,
                        isPublished: true,
                        isFree: true
                    },
                    {
                        title: "Herramientas y T√©cnicas de Diagn√≥stico",
                        description: "Manejo de herramientas b√°sicas para diagn√≥stico: mult√≠metro, destornilladores especializados, pulseras antiest√°ticas. T√©cnicas de diagn√≥stico paso a paso para identificar fallas comunes.",
                        videoUrl: "https://www.youtube.com/watch?v=diagnostic-tools",
                        position: 2,
                        isPublished: true,
                        isFree: true
                    },
                    {
                        title: "Instalaci√≥n y Configuraci√≥n de Sistemas Operativos",
                        description: "Proceso completo de instalaci√≥n de Windows y Linux. Configuraci√≥n b√°sica, drivers, actualizaciones y optimizaci√≥n del sistema para mejor rendimiento.",
                        videoUrl: "https://www.youtube.com/watch?v=os-installation",
                        position: 3,
                        isPublished: true,
                        isFree: true
                    },
                    {
                        title: "Mantenimiento Preventivo y Correctivo",
                        description: "Rutinas de mantenimiento preventivo: limpieza interna, verificaci√≥n de conexiones, monitoreo de temperaturas. Procedimientos de mantenimiento correctivo para fallas espec√≠ficas.",
                        videoUrl: "https://www.youtube.com/watch?v=maintenance",
                        position: 4,
                        isPublished: true,
                        isFree: true
                    }
                ]
            },
            {
                userId: "instructor_tech_2",
                title: "T√©cnico en Electr√≥nica Industrial",
                description: "Programa t√©cnico especializado en electr√≥nica aplicada a la industria. Duraci√≥n de 18 meses con enfoque pr√°ctico en circuitos, automatizaci√≥n y control de procesos.",
                imageUrl: "/programs/electronica.jpg",
                price: 0,
                isPublished: true,
                categoryId: electronicaCategory?.id,
                chapters: [
                    {
                        title: "Fundamentos de Electricidad y Electr√≥nica",
                        description: "Conceptos b√°sicos de voltaje, corriente, resistencia y potencia. Ley de Ohm, circuitos serie y paralelo. Uso del mult√≠metro y osciloscopio b√°sico.",
                        videoUrl: "https://www.youtube.com/watch?v=electronics-basics",
                        position: 1,
                        isPublished: true,
                        isFree: true
                    },
                    {
                        title: "Componentes Electr√≥nicos Pasivos y Activos",
                        description: "Resistencias, capacitores, inductores, diodos, transistores. Identificaci√≥n, pruebas y aplicaciones pr√°cticas de cada componente en circuitos reales.",
                        videoUrl: "https://www.youtube.com/watch?v=electronic-components",
                        position: 2,
                        isPublished: true,
                        isFree: true
                    },
                    {
                        title: "Circuitos Integrados y Microcontroladores",
                        description: "Introducci√≥n a los circuitos integrados. Conceptos b√°sicos de microcontroladores, programaci√≥n simple y aplicaciones en automatizaci√≥n industrial.",
                        videoUrl: "https://www.youtube.com/watch?v=microcontrollers",
                        position: 3,
                        isPublished: true,
                        isFree: true
                    }
                ]
            },
            {
                userId: "instructor_tech_3",
                title: "T√©cnico en Mec√°nica Automotriz",
                description: "Formaci√≥n t√©cnica integral en mec√°nica automotriz. Programa de 18 meses que cubre motor, transmisi√≥n, frenos, suspensi√≥n y sistemas el√©ctricos del autom√≥vil.",
                imageUrl: "/programs/automotriz.jpg",
                price: 0,
                isPublished: true,
                categoryId: mecanicaCategory?.id,
                chapters: [
                    {
                        title: "Sistemas del Motor de Combusti√≥n Interna",
                        description: "Funcionamiento del motor de 4 tiempos, sistemas de lubricaci√≥n, refrigeraci√≥n y combustible. Diagn√≥stico b√°sico de fallas comunes del motor.",
                        videoUrl: "https://www.youtube.com/watch?v=engine-systems",
                        position: 1,
                        isPublished: true,
                        isFree: true
                    },
                    {
                        title: "Sistema de Transmisi√≥n y Embrague",
                        description: "Funcionamiento de transmisiones manuales y autom√°ticas. Diagn√≥stico y reparaci√≥n del sistema de embrague. Mantenimiento preventivo de la transmisi√≥n.",
                        videoUrl: "https://www.youtube.com/watch?v=transmission",
                        position: 2,
                        isPublished: true,
                        isFree: true
                    }
                ]
            },
            {
                userId: "instructor_tech_4",
                title: "T√©cnico en Instalaciones El√©ctricas",
                description: "Programa t√©cnico para formar especialistas en instalaciones el√©ctricas residenciales e industriales. 18 meses de formaci√≥n te√≥rica y pr√°ctica con certificaci√≥n.",
                imageUrl: "/programs/electricidad.jpg",
                price: 0,
                isPublished: true,
                categoryId: electricidadCategory?.id,
                chapters: [
                    {
                        title: "Fundamentos de Electricidad y Seguridad",
                        description: "Conceptos b√°sicos de electricidad, voltaje, corriente alterna y continua. Normas de seguridad el√©ctrica, uso de EPP y procedimientos seguros de trabajo.",
                        videoUrl: "https://www.youtube.com/watch?v=electrical-safety",
                        position: 1,
                        isPublished: true,
                        isFree: true
                    },
                    {
                        title: "Instalaciones El√©ctricas Residenciales",
                        description: "Dise√±o e instalaci√≥n de circuitos residenciales. C√°lculo de cargas, selecci√≥n de conductores, instalaci√≥n de tableros y protecciones el√©ctricas.",
                        videoUrl: "https://www.youtube.com/watch?v=residential-wiring",
                        position: 2,
                        isPublished: true,
                        isFree: true
                    },
                    {
                        title: "Motores El√©ctricos y Control Industrial",
                        description: "Tipos de motores el√©ctricos, conexiones, arranque y control. Contactores, rel√©s t√©rmicos y sistemas b√°sicos de automatizaci√≥n industrial.",
                        videoUrl: "https://www.youtube.com/watch?v=motor-control",
                        position: 3,
                        isPublished: true,
                        isFree: true
                    }
                ]
            }
        ];

        // Crear programas t√©cnicos con sus clases
        for (const programData of technicalPrograms) {
            const { chapters, ...programInfo } = programData;
            
            console.log(`üìñ Creando programa: ${programInfo.title}`);
            
            const program = await database.course.create({
                data: programInfo
            });

            // Crear clases semanales para cada programa
            if (chapters) {
                console.log(`  üìù Creando ${chapters.length} clases semanales...`);
                for (const chapterData of chapters) {
                    await database.chapter.create({
                        data: {
                            ...chapterData,
                            courseId: program.id
                        }
                    });
                }
            }

            // Crear material t√©cnico de apoyo
            await database.attachment.create({
                data: {
                    name: `Manual t√©cnico - ${programInfo.title}.pdf`,
                    url: `/attachments/manual-${program.id}.pdf`,
                    courseId: program.id
                }
            });

            await database.attachment.create({
                data: {
                    name: "Gu√≠a de pr√°cticas de laboratorio.pdf",
                    url: `/attachments/practicas-${program.id}.pdf`,
                    courseId: program.id
                }
            });

            await database.attachment.create({
                data: {
                    name: "Normas de seguridad t√©cnica.pdf",
                    url: `/attachments/seguridad-${program.id}.pdf`,
                    courseId: program.id
                }
            });
        }

        console.log("‚úÖ Programas t√©cnicos creados exitosamente");
        console.log("üéâ Base de datos poblada con contenido t√©cnico real");
        
        // Mostrar resumen
        const totalPrograms = await database.course.count();
        const totalClasses = await database.chapter.count();
        const totalCategories = await database.category.count();
        
        console.log("\nüìä RESUMEN:");
        console.log(`   üìö Especialidades t√©cnicas: ${totalCategories}`);
        console.log(`   üéì Programas t√©cnicos: ${totalPrograms}`);
        console.log(`   üìù Clases semanales: ${totalClasses}`);
        console.log("\nüè≠ ¬°Tu plataforma de formaci√≥n t√©cnica est√° lista!");
        
    } catch (error) {
        console.error("‚ùå Error poblando la base de datos:", error);
    } finally {
        await database.$disconnect();
    }
}

// Ejecutar la funci√≥n main
main()
    .then(() => console.log("\n‚ú® Seeding t√©cnico completado exitosamente"))
    .catch((e) => {
        console.error("üí• Error durante el seeding:", e);
        process.exit(1);
    });